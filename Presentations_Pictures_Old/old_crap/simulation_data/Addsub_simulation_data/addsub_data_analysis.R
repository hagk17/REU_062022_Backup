#read in all data (set correct working directory prior to this)
bar0_data0a = readRDS("bar0_data0a.RData")
bar0_data0b = readRDS("bar0_data0b.RData")
bar0_data1 = readRDS("bar0_data1.RData")
bar0_data2 = readRDS("bar0_data2.RData")
bar0_data3 = readRDS("bar0_data3.RData")
bar0_data4 = readRDS("bar0_data4.RData")
bar0_data5 = readRDS("bar0_data5.RData")
bar0_data6 = readRDS("bar0_data6.RData")
bar0_data7 = readRDS("bar0_data7.RData")
bar0_data8 = readRDS("bar0_data8.RData")
bar0_data9 = readRDS("bar0_data9.RData")
bar0_data10 = readRDS("bar0_data10.RData")
bar1_data0a = readRDS("bar1_data0a.RData")
bar1_data0b = readRDS("bar1_data0b.RData")
bar1_data1 = readRDS("bar1_data1.RData")
bar1_data2 = readRDS("bar1_data2.RData")
bar1_data3 = readRDS("bar1_data3.RData")
bar1_data4 = readRDS("bar1_data4.RData")
bar1_data5 = readRDS("bar1_data5.RData")
bar1_data6 = readRDS("bar1_data6.RData")
bar1_data7 = readRDS("bar1_data7.RData")
bar1_data8 = readRDS("bar1_data8.RData")
bar1_data9 = readRDS("bar1_data9.RData")
bar1_data10 = readRDS("bar1_data10.RData")
bar2_data0a = readRDS("bar2_data0a.RData")
bar2_data0b = readRDS("bar2_data0b.RData")
bar2_data1 = readRDS("bar2_data1.RData")
bar2_data2 = readRDS("bar2_data2.RData")
bar2_data3 = readRDS("bar2_data3.RData")
bar2_data4 = readRDS("bar2_data4.RData")
bar2_data5 = readRDS("bar2_data5.RData")
bar2_data6 = readRDS("bar2_data6.RData")
bar2_data7 = readRDS("bar2_data7.RData")
bar2_data8 = readRDS("bar2_data8.RData")
bar2_data9 = readRDS("bar2_data9.RData")
bar2_data10 = readRDS("bar2_data10.RData")
bar3_data0a = readRDS("bar3_data0a.RData")
bar3_data0b = readRDS("bar3_data0b.RData")
bar3_data1 = readRDS("bar3_data1.RData")
bar3_data2 = readRDS("bar3_data2.RData")
bar3_data3 = readRDS("bar3_data3.RData")
bar3_data4 = readRDS("bar3_data4.RData")
bar3_data5 = readRDS("bar3_data5.RData")
bar3_data6 = readRDS("bar3_data6.RData")
bar3_data7 = readRDS("bar3_data7.RData")
bar3_data8 = readRDS("bar3_data8.RData")
bar3_data9 = readRDS("bar3_data9.RData")
bar3_data10 = readRDS("bar3_data10.RData")
bar4_data0a = readRDS("bar4_data0a.RData")
bar4_data0b = readRDS("bar4_data0b.RData")
bar4_data1 = readRDS("bar4_data1.RData")
bar4_data2 = readRDS("bar4_data2.RData")
bar4_data3 = readRDS("bar4_data3.RData")
bar4_data4 = readRDS("bar4_data4.RData")
bar4_data5 = readRDS("bar4_data5.RData")
bar4_data6 = readRDS("bar4_data6.RData")
bar4_data7 = readRDS("bar4_data7.RData")
bar4_data8 = readRDS("bar4_data8.RData")
bar4_data9 = readRDS("bar4_data9.RData")
bar4_data10 = readRDS("bar4_data10.RData")
bar5_data0a = readRDS("bar5_data0a.RData")
bar5_data0b = readRDS("bar5_data0b.RData")
bar5_data1 = readRDS("bar5_data1.RData")
bar5_data2 = readRDS("bar5_data2.RData")
bar5_data3 = readRDS("bar5_data3.RData")
bar5_data4 = readRDS("bar5_data4.RData")
bar5_data5 = readRDS("bar5_data5.RData")
bar5_data6 = readRDS("bar5_data6.RData")
bar5_data7 = readRDS("bar5_data7.RData")
bar5_data8 = readRDS("bar5_data8.RData")
bar5_data9 = readRDS("bar5_data9.RData")
bar5_data10 = readRDS("bar5_data10.RData")
bar6_data0a = readRDS("bar6_data0a.RData")
bar6_data0b = readRDS("bar6_data0b.RData")
bar6_data1 = readRDS("bar6_data1.RData")
bar6_data2 = readRDS("bar6_data2.RData")
bar6_data3 = readRDS("bar6_data3.RData")
bar6_data4 = readRDS("bar6_data4.RData")
bar6_data5 = readRDS("bar6_data5.RData")
bar6_data6 = readRDS("bar6_data6.RData")
bar6_data7 = readRDS("bar6_data7.RData")
bar6_data8 = readRDS("bar6_data8.RData")
bar6_data9 = readRDS("bar6_data9.RData")
bar6_data10 = readRDS("bar6_data10.RData")
bar7_data0a = readRDS("bar7_data0a.RData")
bar7_data0b = readRDS("bar7_data0b.RData")
bar7_data1 = readRDS("bar7_data1.RData")
bar7_data2 = readRDS("bar7_data2.RData")
bar7_data3 = readRDS("bar7_data3.RData")
bar7_data4 = readRDS("bar7_data4.RData")
bar7_data5 = readRDS("bar7_data5.RData")
bar7_data6 = readRDS("bar7_data6.RData")
bar7_data7 = readRDS("bar7_data7.RData")
bar7_data8 = readRDS("bar7_data8.RData")
bar7_data9 = readRDS("bar7_data9.RData")
bar7_data10 = readRDS("bar7_data10.RData")
bar8_data0a = readRDS("bar8_data0a.RData")
bar8_data0b = readRDS("bar8_data0b.RData")
bar8_data1 = readRDS("bar8_data1.RData")
bar8_data2 = readRDS("bar8_data2.RData")
bar8_data3 = readRDS("bar8_data3.RData")
bar8_data4 = readRDS("bar8_data4.RData")
bar8_data5 = readRDS("bar8_data5.RData")
bar8_data6 = readRDS("bar8_data6.RData")
bar8_data7 = readRDS("bar8_data7.RData")
bar8_data8 = readRDS("bar8_data8.RData")
bar8_data9 = readRDS("bar8_data9.RData")
bar8_data10 = readRDS("bar8_data10.RData")

#names for different training data sets
datanames = c("0 Breaks, Low SD", "0 Breaks, High SD", "1 Break, Clean SD",
"2 Breaks, Clean SD", "1 Break, Messy SD", "2 Breaks, Messy SD", "1 Break, Large Slopes",
"2 Breaks, Large Slopes", "1 Break, Small Slopes", "2 Breaks, Small Slopes",
"1 Break, Diff. Var.", "2 Break, Diff. Var.")

#looking at acceptance rate

##mean and SD for acceptance rate from all simulations
acceptrate_00a = c(mean(bar0_data0a$AcceptRate), sd(bar0_data0a$AcceptRate))
acceptrate_00b = c(mean(bar0_data0b$AcceptRate), sd(bar0_data0b$AcceptRate))
acceptrate_01 = c(mean(bar0_data1$AcceptRate), sd(bar0_data1$AcceptRate))
acceptrate_02 = c(mean(bar0_data2$AcceptRate), sd(bar0_data2$AcceptRate))
acceptrate_03 = c(mean(bar0_data3$AcceptRate), sd(bar0_data3$AcceptRate))
acceptrate_04 = c(mean(bar0_data4$AcceptRate), sd(bar0_data4$AcceptRate))
acceptrate_05 = c(mean(bar0_data5$AcceptRate), sd(bar0_data5$AcceptRate))
acceptrate_06 = c(mean(bar0_data6$AcceptRate), sd(bar0_data6$AcceptRate))
acceptrate_07 = c(mean(bar0_data7$AcceptRate), sd(bar0_data8$AcceptRate))
acceptrate_08 = c(mean(bar0_data8$AcceptRate), sd(bar0_data7$AcceptRate))
acceptrate_09 = c(mean(bar0_data9$AcceptRate), sd(bar0_data9$AcceptRate))
acceptrate_010 = c(mean(bar0_data10$AcceptRate), sd(bar0_data10$AcceptRate))
acceptrate_10a = c(mean(bar1_data0a$AcceptRate), sd(bar1_data0a$AcceptRate))
acceptrate_10b = c(mean(bar1_data0b$AcceptRate), sd(bar1_data0b$AcceptRate))
acceptrate_11 = c(mean(bar1_data1$AcceptRate), sd(bar1_data1$AcceptRate))
acceptrate_12 = c(mean(bar1_data2$AcceptRate), sd(bar1_data2$AcceptRate))
acceptrate_13 = c(mean(bar1_data3$AcceptRate), sd(bar1_data3$AcceptRate))
acceptrate_14 = c(mean(bar1_data4$AcceptRate), sd(bar1_data4$AcceptRate))
acceptrate_15 = c(mean(bar1_data5$AcceptRate), sd(bar1_data5$AcceptRate))
acceptrate_16 = c(mean(bar1_data6$AcceptRate), sd(bar1_data6$AcceptRate))
acceptrate_17 = c(mean(bar1_data7$AcceptRate), sd(bar1_data8$AcceptRate))
acceptrate_18 = c(mean(bar1_data8$AcceptRate), sd(bar1_data7$AcceptRate))
acceptrate_19 = c(mean(bar1_data9$AcceptRate), sd(bar1_data9$AcceptRate))
acceptrate_110 = c(mean(bar1_data10$AcceptRate), sd(bar1_data10$AcceptRate))
acceptrate_20a = c(mean(bar2_data0a$AcceptRate), sd(bar2_data0a$AcceptRate))
acceptrate_20b = c(mean(bar2_data0b$AcceptRate), sd(bar2_data0b$AcceptRate))
acceptrate_21 = c(mean(bar2_data1$AcceptRate), sd(bar2_data1$AcceptRate))
acceptrate_22 = c(mean(bar2_data2$AcceptRate), sd(bar2_data2$AcceptRate))
acceptrate_23 = c(mean(bar2_data3$AcceptRate), sd(bar2_data3$AcceptRate))
acceptrate_24 = c(mean(bar2_data4$AcceptRate), sd(bar2_data4$AcceptRate))
acceptrate_25 = c(mean(bar2_data5$AcceptRate), sd(bar2_data5$AcceptRate))
acceptrate_26 = c(mean(bar2_data6$AcceptRate), sd(bar2_data6$AcceptRate))
acceptrate_27 = c(mean(bar2_data7$AcceptRate), sd(bar2_data8$AcceptRate))
acceptrate_28 = c(mean(bar2_data8$AcceptRate), sd(bar2_data7$AcceptRate))
acceptrate_29 = c(mean(bar2_data9$AcceptRate), sd(bar2_data9$AcceptRate))
acceptrate_210 = c(mean(bar2_data10$AcceptRate), sd(bar2_data10$AcceptRate))
acceptrate_30a = c(mean(bar3_data0a$AcceptRate), sd(bar3_data0a$AcceptRate))
acceptrate_30b = c(mean(bar3_data0b$AcceptRate), sd(bar3_data0b$AcceptRate))
acceptrate_31 = c(mean(bar3_data1$AcceptRate), sd(bar3_data1$AcceptRate))
acceptrate_32 = c(mean(bar3_data2$AcceptRate), sd(bar3_data2$AcceptRate))
acceptrate_33 = c(mean(bar3_data3$AcceptRate), sd(bar3_data3$AcceptRate))
acceptrate_34 = c(mean(bar3_data4$AcceptRate), sd(bar3_data4$AcceptRate))
acceptrate_35 = c(mean(bar3_data5$AcceptRate), sd(bar3_data5$AcceptRate))
acceptrate_36 = c(mean(bar3_data6$AcceptRate), sd(bar3_data6$AcceptRate))
acceptrate_37 = c(mean(bar3_data7$AcceptRate), sd(bar3_data8$AcceptRate))
acceptrate_38 = c(mean(bar3_data8$AcceptRate), sd(bar3_data7$AcceptRate))
acceptrate_39 = c(mean(bar3_data9$AcceptRate), sd(bar3_data9$AcceptRate))
acceptrate_310 = c(mean(bar3_data10$AcceptRate), sd(bar3_data10$AcceptRate))
acceptrate_40a = c(mean(bar4_data0a$AcceptRate), sd(bar4_data0a$AcceptRate))
acceptrate_40b = c(mean(bar4_data0b$AcceptRate), sd(bar4_data0b$AcceptRate))
acceptrate_41 = c(mean(bar4_data1$AcceptRate), sd(bar4_data1$AcceptRate))
acceptrate_42 = c(mean(bar4_data2$AcceptRate), sd(bar4_data2$AcceptRate))
acceptrate_43 = c(mean(bar4_data3$AcceptRate), sd(bar4_data3$AcceptRate))
acceptrate_44 = c(mean(bar4_data4$AcceptRate), sd(bar4_data4$AcceptRate))
acceptrate_45 = c(mean(bar4_data5$AcceptRate), sd(bar4_data5$AcceptRate))
acceptrate_46 = c(mean(bar4_data6$AcceptRate), sd(bar4_data6$AcceptRate))
acceptrate_47 = c(mean(bar4_data7$AcceptRate), sd(bar4_data8$AcceptRate))
acceptrate_48 = c(mean(bar4_data8$AcceptRate), sd(bar4_data7$AcceptRate))
acceptrate_49 = c(mean(bar4_data9$AcceptRate), sd(bar4_data9$AcceptRate))
acceptrate_410 = c(mean(bar4_data10$AcceptRate), sd(bar4_data10$AcceptRate))
acceptrate_50a = c(mean(bar5_data0a$AcceptRate), sd(bar5_data0a$AcceptRate))
acceptrate_50b = c(mean(bar5_data0b$AcceptRate), sd(bar5_data0b$AcceptRate))
acceptrate_51 = c(mean(bar5_data1$AcceptRate), sd(bar5_data1$AcceptRate))
acceptrate_52 = c(mean(bar5_data2$AcceptRate), sd(bar5_data2$AcceptRate))
acceptrate_53 = c(mean(bar5_data3$AcceptRate), sd(bar5_data3$AcceptRate))
acceptrate_54 = c(mean(bar5_data4$AcceptRate), sd(bar5_data4$AcceptRate))
acceptrate_55 = c(mean(bar5_data5$AcceptRate), sd(bar5_data5$AcceptRate))
acceptrate_56 = c(mean(bar5_data6$AcceptRate), sd(bar5_data6$AcceptRate))
acceptrate_57 = c(mean(bar5_data7$AcceptRate), sd(bar5_data8$AcceptRate))
acceptrate_58 = c(mean(bar5_data8$AcceptRate), sd(bar5_data7$AcceptRate))
acceptrate_59 = c(mean(bar5_data9$AcceptRate), sd(bar5_data9$AcceptRate))
acceptrate_510 = c(mean(bar5_data10$AcceptRate), sd(bar5_data10$AcceptRate))
acceptrate_60a = c(mean(bar6_data0a$AcceptRate), sd(bar6_data0a$AcceptRate))
acceptrate_60b = c(mean(bar6_data0b$AcceptRate), sd(bar6_data0b$AcceptRate))
acceptrate_61 = c(mean(bar6_data1$AcceptRate), sd(bar6_data1$AcceptRate))
acceptrate_62 = c(mean(bar6_data2$AcceptRate), sd(bar6_data2$AcceptRate))
acceptrate_63 = c(mean(bar6_data3$AcceptRate), sd(bar6_data3$AcceptRate))
acceptrate_64 = c(mean(bar6_data4$AcceptRate), sd(bar6_data4$AcceptRate))
acceptrate_65 = c(mean(bar6_data5$AcceptRate), sd(bar6_data5$AcceptRate))
acceptrate_66 = c(mean(bar6_data6$AcceptRate), sd(bar6_data6$AcceptRate))
acceptrate_67 = c(mean(bar6_data7$AcceptRate), sd(bar6_data8$AcceptRate))
acceptrate_68 = c(mean(bar6_data8$AcceptRate), sd(bar6_data7$AcceptRate))
acceptrate_69 = c(mean(bar6_data9$AcceptRate), sd(bar6_data9$AcceptRate))
acceptrate_610 = c(mean(bar6_data10$AcceptRate), sd(bar6_data10$AcceptRate))
acceptrate_70a = c(mean(bar7_data0a$AcceptRate), sd(bar7_data0a$AcceptRate))
acceptrate_70b = c(mean(bar7_data0b$AcceptRate), sd(bar7_data0b$AcceptRate))
acceptrate_71 = c(mean(bar7_data1$AcceptRate), sd(bar7_data1$AcceptRate))
acceptrate_72 = c(mean(bar7_data2$AcceptRate), sd(bar7_data2$AcceptRate))
acceptrate_73 = c(mean(bar7_data3$AcceptRate), sd(bar7_data3$AcceptRate))
acceptrate_74 = c(mean(bar7_data4$AcceptRate), sd(bar7_data4$AcceptRate))
acceptrate_75 = c(mean(bar7_data5$AcceptRate), sd(bar7_data5$AcceptRate))
acceptrate_76 = c(mean(bar7_data6$AcceptRate), sd(bar7_data6$AcceptRate))
acceptrate_77 = c(mean(bar7_data7$AcceptRate), sd(bar7_data8$AcceptRate))
acceptrate_78 = c(mean(bar7_data8$AcceptRate), sd(bar7_data7$AcceptRate))
acceptrate_79 = c(mean(bar7_data9$AcceptRate), sd(bar7_data9$AcceptRate))
acceptrate_710 = c(mean(bar7_data10$AcceptRate), sd(bar7_data10$AcceptRate))
acceptrate_80a = c(mean(bar8_data0a$AcceptRate), sd(bar8_data0a$AcceptRate))
acceptrate_80b = c(mean(bar8_data0b$AcceptRate), sd(bar8_data0b$AcceptRate))
acceptrate_81 = c(mean(bar8_data1$AcceptRate), sd(bar8_data1$AcceptRate))
acceptrate_82 = c(mean(bar8_data2$AcceptRate), sd(bar8_data2$AcceptRate))
acceptrate_83 = c(mean(bar8_data3$AcceptRate), sd(bar8_data3$AcceptRate))
acceptrate_84 = c(mean(bar8_data4$AcceptRate), sd(bar8_data4$AcceptRate))
acceptrate_85 = c(mean(bar8_data5$AcceptRate), sd(bar8_data5$AcceptRate))
acceptrate_86 = c(mean(bar8_data6$AcceptRate), sd(bar8_data6$AcceptRate))
acceptrate_87 = c(mean(bar8_data7$AcceptRate), sd(bar8_data8$AcceptRate))
acceptrate_88 = c(mean(bar8_data8$AcceptRate), sd(bar8_data7$AcceptRate))
acceptrate_89 = c(mean(bar8_data9$AcceptRate), sd(bar8_data9$AcceptRate))
acceptrate_810 = c(mean(bar8_data10$AcceptRate), sd(bar8_data10$AcceptRate))

##putting together the acceptance rate means and SD by data set
acceptrate_data0a = c(acceptrate_00a, acceptrate_10a, acceptrate_20a,
acceptrate_30a, acceptrate_40a, acceptrate_50a,
acceptrate_60a, acceptrate_70a, acceptrate_80a, recursive=T)
acceptrate_data0b = c(acceptrate_00b, acceptrate_10b, acceptrate_20b,
acceptrate_30b, acceptrate_40b, acceptrate_50b,
acceptrate_60b, acceptrate_70b, acceptrate_80b, recursive=T)
acceptrate_data1 = c(acceptrate_01, acceptrate_11, acceptrate_21,
acceptrate_31, acceptrate_41, acceptrate_51,
acceptrate_61, acceptrate_71, acceptrate_81, recursive=T)
acceptrate_data2 = c(acceptrate_02, acceptrate_12, acceptrate_22,
acceptrate_32, acceptrate_42, acceptrate_52,
acceptrate_62, acceptrate_72, acceptrate_82, recursive=T)
acceptrate_data3 = c(acceptrate_03, acceptrate_13, acceptrate_23,
acceptrate_33, acceptrate_43, acceptrate_53,
acceptrate_63, acceptrate_73, acceptrate_83, recursive=T)
acceptrate_data4 = c(acceptrate_04, acceptrate_14, acceptrate_24,
acceptrate_34, acceptrate_44, acceptrate_54,
acceptrate_64, acceptrate_74, acceptrate_84, recursive=T)
acceptrate_data5 = c(acceptrate_05, acceptrate_15, acceptrate_25,
acceptrate_35, acceptrate_45, acceptrate_55,
acceptrate_65, acceptrate_75, acceptrate_85, recursive=T)
acceptrate_data6 = c(acceptrate_06, acceptrate_16, acceptrate_26,
acceptrate_36, acceptrate_46, acceptrate_56,
acceptrate_66, acceptrate_76, acceptrate_86, recursive=T)
acceptrate_data7 = c(acceptrate_07, acceptrate_17, acceptrate_27,
acceptrate_37, acceptrate_47, acceptrate_57,
acceptrate_67, acceptrate_77, acceptrate_87, recursive=T)
acceptrate_data8 = c(acceptrate_08, acceptrate_18, acceptrate_28,
acceptrate_38, acceptrate_48, acceptrate_58,
acceptrate_68, acceptrate_78, acceptrate_88, recursive=T)
acceptrate_data9 = c(acceptrate_09, acceptrate_19, acceptrate_29,
acceptrate_39, acceptrate_49, acceptrate_59,
acceptrate_69, acceptrate_79, acceptrate_89, recursive=T)
acceptrate_data10 = c(acceptrate_010, acceptrate_110, acceptrate_210,
acceptrate_310, acceptrate_410, acceptrate_510,
acceptrate_610, acceptrate_710, acceptrate_810, recursive=T)

##creating a single data frame with all summary statistics for acceptance rate
acceptrate = rbind(acceptrate_data0a, acceptrate_data0b, acceptrate_data1, acceptrate_data2,
acceptrate_data3, acceptrate_data4, acceptrate_data5, acceptrate_data6, acceptrate_data7,
acceptrate_data8, acceptrate_data9, acceptrate_data10)
acceptrate = rbind(acceptrate, colMeans(acceptrate))
rownames(acceptrate) = c(datanames, "Total", recursive=T)
colnames(acceptrate) = c("bar0 Mean", "bar0 SD", "bar1 Mean", "bar1 SD", "bar2 Mean", "bar2 SD",
"bar3 Mean", "bar3 SD", "bar4 Mean", "bar4 SD", "bar5 Mean", "bar5 SD",
"bar6 Mean", "bar6 SD", "bar7 Mean", "bar7 SD", "bar8 Mean", "bar8 SD")
round(acceptrate, 5)

#looking at distribution of number of breakpoints (k)

##quantiatively

### getting mean and SD for numberof breakpoints for all files
num_bar0_0a = c(mean(colMeans(bar0_data0a$NumBkpts)), mean(sapply(bar0_data0a$NumBkpts, sd)))
num_bar1_0a = c(mean(colMeans(bar1_data0a$NumBkpts)), mean(sapply(bar1_data0a$NumBkpts, sd)))
num_bar2_0a = c(mean(colMeans(bar2_data0a$NumBkpts)), mean(sapply(bar2_data0a$NumBkpts, sd)))
num_bar3_0a = c(mean(colMeans(bar3_data0a$NumBkpts)), mean(sapply(bar3_data0a$NumBkpts, sd)))
num_bar4_0a = c(mean(colMeans(bar4_data0a$NumBkpts)), mean(sapply(bar4_data0a$NumBkpts, sd)))
num_bar5_0a = c(mean(colMeans(bar5_data0a$NumBkpts)), mean(sapply(bar5_data0a$NumBkpts, sd)))
num_bar6_0a = c(mean(colMeans(bar6_data0a$NumBkpts)), mean(sapply(bar6_data0a$NumBkpts, sd)))
num_bar7_0a = c(mean(colMeans(bar7_data0a$NumBkpts)), mean(sapply(bar7_data0a$NumBkpts, sd)))
num_bar8_0a = c(mean(colMeans(bar8_data0a$NumBkpts)), mean(sapply(bar8_data0a$NumBkpts, sd)))
num_bar0_0b = c(mean(colMeans(bar0_data0b$NumBkpts)), mean(sapply(bar0_data0b$NumBkpts, sd)))
num_bar1_0b = c(mean(colMeans(bar1_data0b$NumBkpts)), mean(sapply(bar1_data0b$NumBkpts, sd)))
num_bar2_0b = c(mean(colMeans(bar2_data0b$NumBkpts)), mean(sapply(bar2_data0b$NumBkpts, sd)))
num_bar3_0b = c(mean(colMeans(bar3_data0b$NumBkpts)), mean(sapply(bar3_data0b$NumBkpts, sd)))
num_bar4_0b = c(mean(colMeans(bar4_data0b$NumBkpts)), mean(sapply(bar4_data0b$NumBkpts, sd)))
num_bar5_0b = c(mean(colMeans(bar5_data0b$NumBkpts)), mean(sapply(bar5_data0b$NumBkpts, sd)))
num_bar6_0b = c(mean(colMeans(bar6_data0b$NumBkpts)), mean(sapply(bar6_data0b$NumBkpts, sd)))
num_bar7_0b = c(mean(colMeans(bar7_data0b$NumBkpts)), mean(sapply(bar7_data0b$NumBkpts, sd)))
num_bar8_0b = c(mean(colMeans(bar8_data0b$NumBkpts)), mean(sapply(bar8_data0b$NumBkpts, sd)))
num_bar0_1 = c(mean(colMeans(bar0_data1$NumBkpts)), mean(sapply(bar0_data1$NumBkpts, sd)))
num_bar1_1 = c(mean(colMeans(bar1_data1$NumBkpts)), mean(sapply(bar1_data1$NumBkpts, sd)))
num_bar2_1 = c(mean(colMeans(bar2_data1$NumBkpts)), mean(sapply(bar2_data1$NumBkpts, sd)))
num_bar3_1 = c(mean(colMeans(bar3_data1$NumBkpts)), mean(sapply(bar3_data1$NumBkpts, sd)))
num_bar4_1 = c(mean(colMeans(bar4_data1$NumBkpts)), mean(sapply(bar4_data1$NumBkpts, sd)))
num_bar5_1 = c(mean(colMeans(bar5_data1$NumBkpts)), mean(sapply(bar5_data1$NumBkpts, sd)))
num_bar6_1 = c(mean(colMeans(bar6_data1$NumBkpts)), mean(sapply(bar6_data1$NumBkpts, sd)))
num_bar7_1 = c(mean(colMeans(bar7_data1$NumBkpts)), mean(sapply(bar7_data1$NumBkpts, sd)))
num_bar8_1 = c(mean(colMeans(bar8_data1$NumBkpts)), mean(sapply(bar8_data1$NumBkpts, sd)))
num_bar0_2 = c(mean(colMeans(bar0_data2$NumBkpts)), mean(sapply(bar0_data2$NumBkpts, sd)))
num_bar1_2 = c(mean(colMeans(bar1_data2$NumBkpts)), mean(sapply(bar1_data2$NumBkpts, sd)))
num_bar2_2 = c(mean(colMeans(bar2_data2$NumBkpts)), mean(sapply(bar2_data2$NumBkpts, sd)))
num_bar3_2 = c(mean(colMeans(bar3_data2$NumBkpts)), mean(sapply(bar3_data2$NumBkpts, sd)))
num_bar4_2 = c(mean(colMeans(bar4_data2$NumBkpts)), mean(sapply(bar4_data2$NumBkpts, sd)))
num_bar5_2 = c(mean(colMeans(bar5_data2$NumBkpts)), mean(sapply(bar5_data2$NumBkpts, sd)))
num_bar6_2 = c(mean(colMeans(bar6_data2$NumBkpts)), mean(sapply(bar6_data2$NumBkpts, sd)))
num_bar7_2 = c(mean(colMeans(bar7_data2$NumBkpts)), mean(sapply(bar7_data2$NumBkpts, sd)))
num_bar8_2 = c(mean(colMeans(bar8_data2$NumBkpts)), mean(sapply(bar8_data2$NumBkpts, sd)))
num_bar0_3 = c(mean(colMeans(bar0_data3$NumBkpts)), mean(sapply(bar0_data3$NumBkpts, sd)))
num_bar1_3 = c(mean(colMeans(bar1_data3$NumBkpts)), mean(sapply(bar1_data3$NumBkpts, sd)))
num_bar2_3 = c(mean(colMeans(bar2_data3$NumBkpts)), mean(sapply(bar2_data3$NumBkpts, sd)))
num_bar3_3 = c(mean(colMeans(bar3_data3$NumBkpts)), mean(sapply(bar3_data3$NumBkpts, sd)))
num_bar4_3 = c(mean(colMeans(bar4_data3$NumBkpts)), mean(sapply(bar4_data3$NumBkpts, sd)))
num_bar5_3 = c(mean(colMeans(bar5_data3$NumBkpts)), mean(sapply(bar5_data3$NumBkpts, sd)))
num_bar6_3 = c(mean(colMeans(bar6_data3$NumBkpts)), mean(sapply(bar6_data3$NumBkpts, sd)))
num_bar7_3 = c(mean(colMeans(bar7_data3$NumBkpts)), mean(sapply(bar7_data3$NumBkpts, sd)))
num_bar8_3 = c(mean(colMeans(bar8_data3$NumBkpts)), mean(sapply(bar8_data3$NumBkpts, sd)))
num_bar0_4 = c(mean(colMeans(bar0_data4$NumBkpts)), mean(sapply(bar0_data4$NumBkpts, sd)))
num_bar1_4 = c(mean(colMeans(bar1_data4$NumBkpts)), mean(sapply(bar1_data4$NumBkpts, sd)))
num_bar2_4 = c(mean(colMeans(bar2_data4$NumBkpts)), mean(sapply(bar2_data4$NumBkpts, sd)))
num_bar3_4 = c(mean(colMeans(bar3_data4$NumBkpts)), mean(sapply(bar3_data4$NumBkpts, sd)))
num_bar4_4 = c(mean(colMeans(bar4_data4$NumBkpts)), mean(sapply(bar4_data4$NumBkpts, sd)))
num_bar5_4 = c(mean(colMeans(bar5_data4$NumBkpts)), mean(sapply(bar5_data4$NumBkpts, sd)))
num_bar6_4 = c(mean(colMeans(bar6_data4$NumBkpts)), mean(sapply(bar6_data4$NumBkpts, sd)))
num_bar7_4 = c(mean(colMeans(bar7_data4$NumBkpts)), mean(sapply(bar7_data4$NumBkpts, sd)))
num_bar8_4 = c(mean(colMeans(bar8_data4$NumBkpts)), mean(sapply(bar8_data4$NumBkpts, sd)))
num_bar0_5 = c(mean(colMeans(bar0_data5$NumBkpts)), mean(sapply(bar0_data5$NumBkpts, sd)))
num_bar1_5 = c(mean(colMeans(bar1_data5$NumBkpts)), mean(sapply(bar1_data5$NumBkpts, sd)))
num_bar2_5 = c(mean(colMeans(bar2_data5$NumBkpts)), mean(sapply(bar2_data5$NumBkpts, sd)))
num_bar3_5 = c(mean(colMeans(bar3_data5$NumBkpts)), mean(sapply(bar3_data5$NumBkpts, sd)))
num_bar4_5 = c(mean(colMeans(bar4_data5$NumBkpts)), mean(sapply(bar4_data5$NumBkpts, sd)))
num_bar5_5 = c(mean(colMeans(bar5_data5$NumBkpts)), mean(sapply(bar5_data5$NumBkpts, sd)))
num_bar6_5 = c(mean(colMeans(bar6_data5$NumBkpts)), mean(sapply(bar6_data5$NumBkpts, sd)))
num_bar7_5 = c(mean(colMeans(bar7_data5$NumBkpts)), mean(sapply(bar7_data5$NumBkpts, sd)))
num_bar8_5 = c(mean(colMeans(bar8_data5$NumBkpts)), mean(sapply(bar8_data5$NumBkpts, sd)))
num_bar0_6 = c(mean(colMeans(bar0_data6$NumBkpts)), mean(sapply(bar0_data6$NumBkpts, sd)))
num_bar1_6 = c(mean(colMeans(bar1_data6$NumBkpts)), mean(sapply(bar1_data6$NumBkpts, sd)))
num_bar2_6 = c(mean(colMeans(bar2_data6$NumBkpts)), mean(sapply(bar2_data6$NumBkpts, sd)))
num_bar3_6 = c(mean(colMeans(bar3_data6$NumBkpts)), mean(sapply(bar3_data6$NumBkpts, sd)))
num_bar4_6 = c(mean(colMeans(bar4_data6$NumBkpts)), mean(sapply(bar4_data6$NumBkpts, sd)))
num_bar5_6 = c(mean(colMeans(bar5_data6$NumBkpts)), mean(sapply(bar5_data6$NumBkpts, sd)))
num_bar6_6 = c(mean(colMeans(bar6_data6$NumBkpts)), mean(sapply(bar6_data6$NumBkpts, sd)))
num_bar7_6 = c(mean(colMeans(bar7_data6$NumBkpts)), mean(sapply(bar7_data6$NumBkpts, sd)))
num_bar8_6 = c(mean(colMeans(bar8_data6$NumBkpts)), mean(sapply(bar8_data6$NumBkpts, sd)))
num_bar0_7 = c(mean(colMeans(bar0_data7$NumBkpts)), mean(sapply(bar0_data7$NumBkpts, sd)))
num_bar1_7 = c(mean(colMeans(bar1_data7$NumBkpts)), mean(sapply(bar1_data7$NumBkpts, sd)))
num_bar2_7 = c(mean(colMeans(bar2_data7$NumBkpts)), mean(sapply(bar2_data7$NumBkpts, sd)))
num_bar3_7 = c(mean(colMeans(bar3_data7$NumBkpts)), mean(sapply(bar3_data7$NumBkpts, sd)))
num_bar4_7 = c(mean(colMeans(bar4_data7$NumBkpts)), mean(sapply(bar4_data7$NumBkpts, sd)))
num_bar5_7 = c(mean(colMeans(bar5_data7$NumBkpts)), mean(sapply(bar5_data7$NumBkpts, sd)))
num_bar6_7 = c(mean(colMeans(bar6_data7$NumBkpts)), mean(sapply(bar6_data7$NumBkpts, sd)))
num_bar7_7 = c(mean(colMeans(bar7_data7$NumBkpts)), mean(sapply(bar7_data7$NumBkpts, sd)))
num_bar8_7 = c(mean(colMeans(bar8_data7$NumBkpts)), mean(sapply(bar8_data7$NumBkpts, sd)))
num_bar0_8 = c(mean(colMeans(bar0_data8$NumBkpts)), mean(sapply(bar0_data8$NumBkpts, sd)))
num_bar1_8 = c(mean(colMeans(bar1_data8$NumBkpts)), mean(sapply(bar1_data8$NumBkpts, sd)))
num_bar2_8 = c(mean(colMeans(bar2_data8$NumBkpts)), mean(sapply(bar2_data8$NumBkpts, sd)))
num_bar3_8 = c(mean(colMeans(bar3_data8$NumBkpts)), mean(sapply(bar3_data8$NumBkpts, sd)))
num_bar4_8 = c(mean(colMeans(bar4_data8$NumBkpts)), mean(sapply(bar4_data8$NumBkpts, sd)))
num_bar5_8 = c(mean(colMeans(bar5_data8$NumBkpts)), mean(sapply(bar5_data8$NumBkpts, sd)))
num_bar6_8 = c(mean(colMeans(bar6_data8$NumBkpts)), mean(sapply(bar6_data8$NumBkpts, sd)))
num_bar7_8 = c(mean(colMeans(bar7_data8$NumBkpts)), mean(sapply(bar7_data8$NumBkpts, sd)))
num_bar8_8 = c(mean(colMeans(bar8_data8$NumBkpts)), mean(sapply(bar8_data8$NumBkpts, sd)))
num_bar0_9 = c(mean(colMeans(bar0_data9$NumBkpts)), mean(sapply(bar0_data9$NumBkpts, sd)))
num_bar1_9 = c(mean(colMeans(bar1_data9$NumBkpts)), mean(sapply(bar1_data9$NumBkpts, sd)))
num_bar2_9 = c(mean(colMeans(bar2_data9$NumBkpts)), mean(sapply(bar2_data9$NumBkpts, sd)))
num_bar3_9 = c(mean(colMeans(bar3_data9$NumBkpts)), mean(sapply(bar3_data9$NumBkpts, sd)))
num_bar4_9 = c(mean(colMeans(bar4_data9$NumBkpts)), mean(sapply(bar4_data9$NumBkpts, sd)))
num_bar5_9 = c(mean(colMeans(bar5_data9$NumBkpts)), mean(sapply(bar5_data9$NumBkpts, sd)))
num_bar6_9 = c(mean(colMeans(bar6_data9$NumBkpts)), mean(sapply(bar6_data9$NumBkpts, sd)))
num_bar7_9 = c(mean(colMeans(bar7_data9$NumBkpts)), mean(sapply(bar7_data9$NumBkpts, sd)))
num_bar8_9 = c(mean(colMeans(bar8_data9$NumBkpts)), mean(sapply(bar8_data9$NumBkpts, sd)))
num_bar0_10 = c(mean(colMeans(bar0_data10$NumBkpts)), mean(sapply(bar0_data10$NumBkpts, sd)))
num_bar1_10 = c(mean(colMeans(bar1_data10$NumBkpts)), mean(sapply(bar1_data10$NumBkpts, sd)))
num_bar2_10 = c(mean(colMeans(bar2_data10$NumBkpts)), mean(sapply(bar2_data10$NumBkpts, sd)))
num_bar3_10 = c(mean(colMeans(bar3_data10$NumBkpts)), mean(sapply(bar3_data10$NumBkpts, sd)))
num_bar4_10 = c(mean(colMeans(bar4_data10$NumBkpts)), mean(sapply(bar4_data10$NumBkpts, sd)))
num_bar5_10 = c(mean(colMeans(bar5_data10$NumBkpts)), mean(sapply(bar5_data10$NumBkpts, sd)))
num_bar6_10 = c(mean(colMeans(bar6_data10$NumBkpts)), mean(sapply(bar6_data10$NumBkpts, sd)))
num_bar7_10 = c(mean(colMeans(bar7_data10$NumBkpts)), mean(sapply(bar7_data10$NumBkpts, sd)))
num_bar8_10 = c(mean(colMeans(bar8_data10$NumBkpts)), mean(sapply(bar8_data10$NumBkpts, sd)))

###put all means and SDs together by data
num_data0a = c(num_bar0_0a, num_bar1_0a, num_bar2_0a, num_bar3_0a, num_bar4_0a,
num_bar5_0a, num_bar6_0a, num_bar7_0a, num_bar8_0a, recursive=T)
num_data0b = c(num_bar0_0b, num_bar1_0b, num_bar2_0b, num_bar3_0b, num_bar4_0b,
num_bar5_0b, num_bar6_0b, num_bar7_0b, num_bar8_0b, recursive=T)
num_data1 = c(num_bar0_1, num_bar1_1, num_bar2_1, num_bar3_1, num_bar4_1,
num_bar5_1, num_bar6_1, num_bar7_1, num_bar8_1, recursive=T)
num_data2 = c(num_bar0_2, num_bar1_2, num_bar2_2, num_bar3_2, num_bar4_2,
num_bar5_2, num_bar6_2, num_bar7_2, num_bar8_2, recursive=T)
num_data3 = c(num_bar0_3, num_bar1_3, num_bar2_3, num_bar3_3, num_bar4_3,
num_bar5_3, num_bar6_3, num_bar7_3, num_bar8_3, recursive=T)
num_data4 = c(num_bar0_4, num_bar1_4, num_bar2_4, num_bar3_4, num_bar4_4,
num_bar5_4, num_bar6_4, num_bar7_4, num_bar8_4, recursive=T)
num_data5 = c(num_bar0_5, num_bar1_5, num_bar2_5, num_bar3_5, num_bar4_5,
num_bar5_5, num_bar6_5, num_bar7_5, num_bar8_5, recursive=T)
num_data6 = c(num_bar0_6, num_bar1_6, num_bar2_6, num_bar3_6, num_bar4_6,
num_bar5_6, num_bar6_6, num_bar7_6, num_bar8_6, recursive=T)
num_data7 = c(num_bar0_7, num_bar1_7, num_bar2_7, num_bar3_7, num_bar4_7,
num_bar5_7, num_bar6_7, num_bar7_7, num_bar8_7, recursive=T)
num_data8 = c(num_bar0_8, num_bar1_8, num_bar2_8, num_bar3_8, num_bar4_8,
num_bar5_8, num_bar6_8, num_bar7_8, num_bar8_8, recursive=T)
num_data9 = c(num_bar0_9, num_bar1_9, num_bar2_9, num_bar3_9, num_bar4_9,
num_bar5_9, num_bar6_9, num_bar7_9, num_bar8_9, recursive=T)
num_data10 = c(num_bar0_10, num_bar1_10, num_bar2_10, num_bar3_10, num_bar4_10,
num_bar5_10, num_bar6_10, num_bar7_10, num_bar8_10, recursive=T)

###create single data frame which shows error (mean - true) and SD for all variations
num = rbind(num_data0a, num_data0b, num_data1, num_data2,
num_data3, num_data4, num_data5, num_data6, num_data7,
num_data8, num_data9, num_data10)
rownames(num) = c(datanames, recursive=T)
colnames(num) = c("bar0 Mean", "bar0 SD", "bar1 Mean", "bar1 SD", "bar2 Mean", "bar2 SD",
"bar3 Mean", "bar3 SD", "bar4 Mean", "bar4 SD", "bar5 Mean", "bar5 SD",
"bar6 Mean", "bar6 SD", "bar7 Mean", "bar7 SD", "bar8 Mean", "bar8 SD")
num[1,c(1,3,5,7,9,11,13,15,17)] = num[1,c(1,3,5,7,9,11,13,15,17)]-0
num[2,c(1,3,5,7,9,11,13,15,17)] = num[2,c(1,3,5,7,9,11,13,15,17)]-0
num[3,c(1,3,5,7,9,11,13,15,17)] = num[3,c(1,3,5,7,9,11,13,15,17)]-1
num[4,c(1,3,5,7,9,11,13,15,17)] = num[4,c(1,3,5,7,9,11,13,15,17)]-2
num[5,c(1,3,5,7,9,11,13,15,17)] = num[5,c(1,3,5,7,9,11,13,15,17)]-1
num[6,c(1,3,5,7,9,11,13,15,17)] = num[6,c(1,3,5,7,9,11,13,15,17)]-2
num[7,c(1,3,5,7,9,11,13,15,17)] = num[7,c(1,3,5,7,9,11,13,15,17)]-1
num[8,c(1,3,5,7,9,11,13,15,17)] = num[8,c(1,3,5,7,9,11,13,15,17)]-2
num[9,c(1,3,5,7,9,11,13,15,17)] = num[9,c(1,3,5,7,9,11,13,15,17)]-1
num[10,c(1,3,5,7,9,11,13,15,17)] = num[10,c(1,3,5,7,9,11,13,15,17)]-2
num[11,c(1,3,5,7,9,11,13,15,17)] = num[11,c(1,3,5,7,9,11,13,15,17)]-1
num[12,c(1,3,5,7,9,11,13,15,17)] = num[12,c(1,3,5,7,9,11,13,15,17)]-2
num = rbind(num, colMeans(num))
rownames(num) = c(datanames, "Total", recursive=T)
round(num, 5)

##graphically

par(mfrow=c(1,2))
hist(c(bar0_data2$NumBkpts[[1]], bar0_data2$NumBkpts[[2]], bar0_data2$NumBkpts[[3]],
bar0_data2$NumBkpts[[4]], bar0_data2$NumBkpts[[5]], bar0_data2$NumBkpts[[6]],
bar0_data2$NumBkpts[[7]], bar0_data2$NumBkpts[[8]], bar0_data2$NumBkpts[[9]], recursive=T),
ylim=c(0,20000), xlim=c(1,13), breaks=c(1:13), col="red", right=F,
main="BAR 0", ylab="Number of Iterations Out of 27,000",
xlab="Number of Breakpoints")
hist(c(bar6_data2$NumBkpts[[1]], bar6_data2$NumBkpts[[2]], bar6_data2$NumBkpts[[3]],
bar6_data2$NumBkpts[[4]], bar6_data2$NumBkpts[[5]], bar6_data2$NumBkpts[[6]],
bar6_data2$NumBkpts[[7]], bar6_data2$NumBkpts[[8]], bar6_data2$NumBkpts[[9]], recursive=T),
ylim=c(0,20000), xlim=c(1,13), breaks=c(1:13), col="blue", right=F,
main="BAR 6", ylab="Number of Iterations Out of 27,000",
xlab="Number of Breakpoints")


###specify which simulation you want to look at right now
current_sim = barB_data2$NumBkpts
current_title = "barB - Data 2"
###specify correct number of breakpoints for this training set
current_true = 2

###set graphical parameters
x_label = "Number of Breakpoints"
y_label = "Number of Iterations"
n_breaks = c(0:10)
x_limits = c(0,10)
y_lower = 0
y_upper = 2500
line_type = 1
line_width = 2

###plot distributions of number of breakpoints
par(mfrow=c(3,3))
hist(current_sim[[1]], main=current_title, xlab=x_label, ylab=y_label, breaks=n_breaks, xlim=x_limits, ylim=c(y_lower,y_upper))
lines(c(current_true+0.5,current_true+0.5), c(y_lower,y_upper), col="red", lty=line_type, lwd=line_width)
hist(current_sim[[2]], main=current_title, xlab=x_label, ylab=y_label, breaks=n_breaks, xlim=x_limits, ylim=c(y_lower,y_upper))
lines(c(current_true+0.5,current_true+0.5), c(y_lower,y_upper), col="red", lty=line_type, lwd=line_width)
hist(current_sim[[3]], main=current_title, xlab=x_label, ylab=y_label, breaks=n_breaks, xlim=x_limits, ylim=c(y_lower,y_upper))
lines(c(current_true+0.5,current_true+0.5), c(y_lower,y_upper), col="red", lty=line_type, lwd=line_width)
hist(current_sim[[4]], main=current_title, xlab=x_label, ylab=y_label, breaks=n_breaks, xlim=x_limits, ylim=c(y_lower,y_upper))
lines(c(current_true+0.5,current_true+0.5), c(y_lower,y_upper), col="red", lty=line_type, lwd=line_width)
hist(current_sim[[5]], main=current_title, xlab=x_label, ylab=y_label, breaks=n_breaks, xlim=x_limits, ylim=c(y_lower,y_upper))
lines(c(current_true+0.5,current_true+0.5), c(y_lower,y_upper), col="red", lty=line_type, lwd=line_width)
hist(current_sim[[6]], main=current_title, xlab=x_label, ylab=y_label, breaks=n_breaks, xlim=x_limits, ylim=c(y_lower,y_upper))
lines(c(current_true+0.5,current_true+0.5), c(y_lower,y_upper), col="red", lty=line_type, lwd=line_width)
hist(current_sim[[7]], main=current_title, xlab=x_label, ylab=y_label, breaks=n_breaks, xlim=x_limits, ylim=c(y_lower,y_upper))
lines(c(current_true+0.5,current_true+0.5), c(y_lower,y_upper), col="red", lty=line_type, lwd=line_width)
hist(current_sim[[8]], main=current_title, xlab=x_label, ylab=y_label, breaks=n_breaks, xlim=x_limits, ylim=c(y_lower,y_upper))
lines(c(current_true+0.5,current_true+0.5), c(y_lower,y_upper), col="red", lty=line_type, lwd=line_width)
hist(current_sim[[9]], main=current_title, xlab=x_label, ylab=y_label, breaks=n_breaks, xlim=x_limits, ylim=c(y_lower,y_upper))
lines(c(current_true+0.5,current_true+0.5), c(y_lower,y_upper), col="red", lty=line_type, lwd=line_width)

#looking at distribution of breakpoint locations (tau)

##quantitatively

###function for placing all breakpoints for one file into a single list
all_breakpoints = function(breakpoints){

final_breakpoints = NULL

if(length(breakpoints) == 0){
	return("")
}else{
	for(m in 1:length(breakpoints)){
		if(is.atomic(breakpoints[[m]]) == TRUE) {
			final_breakpoints = c(final_breakpoints, breakpoints[[m]], recursive=T)
		}else if(dim(breakpoints[[m]])[2] >= 2) {
			column_list = NULL
			for(i in 1:dim(breakpoints[[m]])[2]){
				column_list = c(column_list, breakpoints[[m]][,i], recursive=T)
			}
			final_breakpoints = c(final_breakpoints, column_list, recursive=T)	
		}
	}
return(final_breakpoints)
}

}

###getting breakpoints that occur more times than threshold for each file
bkpts_bar0_data0a = as.data.frame(sort(table(na.omit(all_breakpoints(bar0_data0a$Breakpoints))), decreasing=T))
bkpts_bar0_data0b = as.data.frame(sort(table(na.omit(all_breakpoints(bar0_data0b$Breakpoints))), decreasing=T))
bkpts_bar0_data1 = as.data.frame(sort(table(na.omit(all_breakpoints(bar0_data1$Breakpoints))), decreasing=T))
bkpts_bar0_data2 = as.data.frame(sort(table(na.omit(all_breakpoints(bar0_data2$Breakpoints))), decreasing=T))
bkpts_bar0_data3 = as.data.frame(sort(table(na.omit(all_breakpoints(bar0_data3$Breakpoints))), decreasing=T))
bkpts_bar0_data4 = as.data.frame(sort(table(na.omit(all_breakpoints(bar0_data4$Breakpoints))), decreasing=T))
bkpts_bar0_data5 = as.data.frame(sort(table(na.omit(all_breakpoints(bar0_data5$Breakpoints))), decreasing=T))
bkpts_bar0_data6 = as.data.frame(sort(table(na.omit(all_breakpoints(bar0_data6$Breakpoints))), decreasing=T))
bkpts_bar0_data7 = as.data.frame(sort(table(na.omit(all_breakpoints(bar0_data7$Breakpoints))), decreasing=T))
bkpts_bar0_data8 = as.data.frame(sort(table(na.omit(all_breakpoints(bar0_data8$Breakpoints))), decreasing=T))
bkpts_bar0_data9 = as.data.frame(sort(table(na.omit(all_breakpoints(bar0_data9$Breakpoints))), decreasing=T))
bkpts_bar0_data10 = as.data.frame(sort(table(na.omit(all_breakpoints(bar0_data10$Breakpoints))), decreasing=T))
bkpts_bar1_data0a = as.data.frame(sort(table(na.omit(all_breakpoints(bar1_data0a$Breakpoints))), decreasing=T))
bkpts_bar1_data0b = as.data.frame(sort(table(na.omit(all_breakpoints(bar1_data0b$Breakpoints))), decreasing=T))
bkpts_bar1_data1 = as.data.frame(sort(table(na.omit(all_breakpoints(bar1_data1$Breakpoints))), decreasing=T))
bkpts_bar1_data2 = as.data.frame(sort(table(na.omit(all_breakpoints(bar1_data2$Breakpoints))), decreasing=T))
bkpts_bar1_data3 = as.data.frame(sort(table(na.omit(all_breakpoints(bar1_data3$Breakpoints))), decreasing=T))
bkpts_bar1_data4 = as.data.frame(sort(table(na.omit(all_breakpoints(bar1_data4$Breakpoints))), decreasing=T))
bkpts_bar1_data5 = as.data.frame(sort(table(na.omit(all_breakpoints(bar1_data5$Breakpoints))), decreasing=T))
bkpts_bar1_data6 = as.data.frame(sort(table(na.omit(all_breakpoints(bar1_data6$Breakpoints))), decreasing=T))
bkpts_bar1_data7 = as.data.frame(sort(table(na.omit(all_breakpoints(bar1_data7$Breakpoints))), decreasing=T))
bkpts_bar1_data8 = as.data.frame(sort(table(na.omit(all_breakpoints(bar1_data8$Breakpoints))), decreasing=T))
bkpts_bar1_data9 = as.data.frame(sort(table(na.omit(all_breakpoints(bar1_data9$Breakpoints))), decreasing=T))
bkpts_bar1_data10 = as.data.frame(sort(table(na.omit(all_breakpoints(bar1_data10$Breakpoints))), decreasing=T))
bkpts_bar2_data0a = as.data.frame(sort(table(na.omit(all_breakpoints(bar2_data0a$Breakpoints))), decreasing=T))
bkpts_bar2_data0b = as.data.frame(sort(table(na.omit(all_breakpoints(bar2_data0b$Breakpoints))), decreasing=T))
bkpts_bar2_data1 = as.data.frame(sort(table(na.omit(all_breakpoints(bar2_data1$Breakpoints))), decreasing=T))
bkpts_bar2_data2 = as.data.frame(sort(table(na.omit(all_breakpoints(bar2_data2$Breakpoints))), decreasing=T))
bkpts_bar2_data3 = as.data.frame(sort(table(na.omit(all_breakpoints(bar2_data3$Breakpoints))), decreasing=T))
bkpts_bar2_data4 = as.data.frame(sort(table(na.omit(all_breakpoints(bar2_data4$Breakpoints))), decreasing=T))
bkpts_bar2_data5 = as.data.frame(sort(table(na.omit(all_breakpoints(bar2_data5$Breakpoints))), decreasing=T))
bkpts_bar2_data6 = as.data.frame(sort(table(na.omit(all_breakpoints(bar2_data6$Breakpoints))), decreasing=T))
bkpts_bar2_data7 = as.data.frame(sort(table(na.omit(all_breakpoints(bar2_data7$Breakpoints))), decreasing=T))
bkpts_bar2_data8 = as.data.frame(sort(table(na.omit(all_breakpoints(bar2_data8$Breakpoints))), decreasing=T))
bkpts_bar2_data9 = as.data.frame(sort(table(na.omit(all_breakpoints(bar2_data9$Breakpoints))), decreasing=T))
bkpts_bar2_data10 = as.data.frame(sort(table(na.omit(all_breakpoints(bar2_data10$Breakpoints))), decreasing=T))
bkpts_bar3_data0a = as.data.frame(sort(table(na.omit(all_breakpoints(bar3_data0a$Breakpoints))), decreasing=T))
bkpts_bar3_data0b = as.data.frame(sort(table(na.omit(all_breakpoints(bar3_data0b$Breakpoints))), decreasing=T))
bkpts_bar3_data1 = as.data.frame(sort(table(na.omit(all_breakpoints(bar3_data1$Breakpoints))), decreasing=T))
bkpts_bar3_data2 = as.data.frame(sort(table(na.omit(all_breakpoints(bar3_data2$Breakpoints))), decreasing=T))
bkpts_bar3_data3 = as.data.frame(sort(table(na.omit(all_breakpoints(bar3_data3$Breakpoints))), decreasing=T))
bkpts_bar3_data4 = as.data.frame(sort(table(na.omit(all_breakpoints(bar3_data4$Breakpoints))), decreasing=T))
bkpts_bar3_data5 = as.data.frame(sort(table(na.omit(all_breakpoints(bar3_data5$Breakpoints))), decreasing=T))
bkpts_bar3_data6 = as.data.frame(sort(table(na.omit(all_breakpoints(bar3_data6$Breakpoints))), decreasing=T))
bkpts_bar3_data7 = as.data.frame(sort(table(na.omit(all_breakpoints(bar3_data7$Breakpoints))), decreasing=T))
bkpts_bar3_data8 = as.data.frame(sort(table(na.omit(all_breakpoints(bar3_data8$Breakpoints))), decreasing=T))
bkpts_bar3_data9 = as.data.frame(sort(table(na.omit(all_breakpoints(bar3_data9$Breakpoints))), decreasing=T))
bkpts_bar3_data10 = as.data.frame(sort(table(na.omit(all_breakpoints(bar3_data10$Breakpoints))), decreasing=T))
bkpts_bar4_data0a = as.data.frame(sort(table(na.omit(all_breakpoints(bar4_data0a$Breakpoints))), decreasing=T))
bkpts_bar4_data0b = as.data.frame(sort(table(na.omit(all_breakpoints(bar4_data0b$Breakpoints))), decreasing=T))
bkpts_bar4_data1 = as.data.frame(sort(table(na.omit(all_breakpoints(bar4_data1$Breakpoints))), decreasing=T))
bkpts_bar4_data2 = as.data.frame(sort(table(na.omit(all_breakpoints(bar4_data2$Breakpoints))), decreasing=T))
bkpts_bar4_data3 = as.data.frame(sort(table(na.omit(all_breakpoints(bar4_data3$Breakpoints))), decreasing=T))
bkpts_bar4_data4 = as.data.frame(sort(table(na.omit(all_breakpoints(bar4_data4$Breakpoints))), decreasing=T))
bkpts_bar4_data5 = as.data.frame(sort(table(na.omit(all_breakpoints(bar4_data5$Breakpoints))), decreasing=T))
bkpts_bar4_data6 = as.data.frame(sort(table(na.omit(all_breakpoints(bar4_data6$Breakpoints))), decreasing=T))
bkpts_bar4_data7 = as.data.frame(sort(table(na.omit(all_breakpoints(bar4_data7$Breakpoints))), decreasing=T))
bkpts_bar4_data8 = as.data.frame(sort(table(na.omit(all_breakpoints(bar4_data8$Breakpoints))), decreasing=T))
bkpts_bar4_data9 = as.data.frame(sort(table(na.omit(all_breakpoints(bar4_data9$Breakpoints))), decreasing=T))
bkpts_bar4_data10 = as.data.frame(sort(table(na.omit(all_breakpoints(bar4_data10$Breakpoints))), decreasing=T))
bkpts_bar5_data0a = as.data.frame(sort(table(na.omit(all_breakpoints(bar5_data0a$Breakpoints))), decreasing=T))
bkpts_bar5_data0b = as.data.frame(sort(table(na.omit(all_breakpoints(bar5_data0b$Breakpoints))), decreasing=T))
bkpts_bar5_data1 = as.data.frame(sort(table(na.omit(all_breakpoints(bar5_data1$Breakpoints))), decreasing=T))
bkpts_bar5_data2 = as.data.frame(sort(table(na.omit(all_breakpoints(bar5_data2$Breakpoints))), decreasing=T))
bkpts_bar5_data3 = as.data.frame(sort(table(na.omit(all_breakpoints(bar5_data3$Breakpoints))), decreasing=T))
bkpts_bar5_data4 = as.data.frame(sort(table(na.omit(all_breakpoints(bar5_data4$Breakpoints))), decreasing=T))
bkpts_bar5_data5 = as.data.frame(sort(table(na.omit(all_breakpoints(bar5_data5$Breakpoints))), decreasing=T))
bkpts_bar5_data6 = as.data.frame(sort(table(na.omit(all_breakpoints(bar5_data6$Breakpoints))), decreasing=T))
bkpts_bar5_data7 = as.data.frame(sort(table(na.omit(all_breakpoints(bar5_data7$Breakpoints))), decreasing=T))
bkpts_bar5_data8 = as.data.frame(sort(table(na.omit(all_breakpoints(bar5_data8$Breakpoints))), decreasing=T))
bkpts_bar5_data9 = as.data.frame(sort(table(na.omit(all_breakpoints(bar5_data9$Breakpoints))), decreasing=T))
bkpts_bar5_data10 = as.data.frame(sort(table(na.omit(all_breakpoints(bar5_data10$Breakpoints))), decreasing=T))
bkpts_bar6_data0a = as.data.frame(sort(table(na.omit(all_breakpoints(bar6_data0a$Breakpoints))), decreasing=T))
bkpts_bar6_data0b = as.data.frame(sort(table(na.omit(all_breakpoints(bar6_data0b$Breakpoints))), decreasing=T))
bkpts_bar6_data1 = as.data.frame(sort(table(na.omit(all_breakpoints(bar6_data1$Breakpoints))), decreasing=T))
bkpts_bar6_data2 = as.data.frame(sort(table(na.omit(all_breakpoints(bar6_data2$Breakpoints))), decreasing=T))
bkpts_bar6_data3 = as.data.frame(sort(table(na.omit(all_breakpoints(bar6_data3$Breakpoints))), decreasing=T))
bkpts_bar6_data4 = as.data.frame(sort(table(na.omit(all_breakpoints(bar6_data4$Breakpoints))), decreasing=T))
bkpts_bar6_data5 = as.data.frame(sort(table(na.omit(all_breakpoints(bar6_data5$Breakpoints))), decreasing=T))
bkpts_bar6_data6 = as.data.frame(sort(table(na.omit(all_breakpoints(bar6_data6$Breakpoints))), decreasing=T))
bkpts_bar6_data7 = as.data.frame(sort(table(na.omit(all_breakpoints(bar6_data7$Breakpoints))), decreasing=T))
bkpts_bar6_data8 = as.data.frame(sort(table(na.omit(all_breakpoints(bar6_data8$Breakpoints))), decreasing=T))
bkpts_bar6_data9 = as.data.frame(sort(table(na.omit(all_breakpoints(bar6_data9$Breakpoints))), decreasing=T))
bkpts_bar6_data10 = as.data.frame(sort(table(na.omit(all_breakpoints(bar6_data10$Breakpoints))), decreasing=T))
bkpts_bar7_data0a = as.data.frame(sort(table(na.omit(all_breakpoints(bar7_data0a$Breakpoints))), decreasing=T))
bkpts_bar7_data0b = as.data.frame(sort(table(na.omit(all_breakpoints(bar7_data0b$Breakpoints))), decreasing=T))
bkpts_bar7_data1 = as.data.frame(sort(table(na.omit(all_breakpoints(bar7_data1$Breakpoints))), decreasing=T))
bkpts_bar7_data2 = as.data.frame(sort(table(na.omit(all_breakpoints(bar7_data2$Breakpoints))), decreasing=T))
bkpts_bar7_data3 = as.data.frame(sort(table(na.omit(all_breakpoints(bar7_data3$Breakpoints))), decreasing=T))
bkpts_bar7_data4 = as.data.frame(sort(table(na.omit(all_breakpoints(bar7_data4$Breakpoints))), decreasing=T))
bkpts_bar7_data5 = as.data.frame(sort(table(na.omit(all_breakpoints(bar7_data5$Breakpoints))), decreasing=T))
bkpts_bar7_data6 = as.data.frame(sort(table(na.omit(all_breakpoints(bar7_data6$Breakpoints))), decreasing=T))
bkpts_bar7_data7 = as.data.frame(sort(table(na.omit(all_breakpoints(bar7_data7$Breakpoints))), decreasing=T))
bkpts_bar7_data8 = as.data.frame(sort(table(na.omit(all_breakpoints(bar7_data8$Breakpoints))), decreasing=T))
bkpts_bar7_data9 = as.data.frame(sort(table(na.omit(all_breakpoints(bar7_data9$Breakpoints))), decreasing=T))
bkpts_bar7_data10 = as.data.frame(sort(table(na.omit(all_breakpoints(bar7_data10$Breakpoints))), decreasing=T))
bkpts_bar8_data0a = as.data.frame(sort(table(na.omit(all_breakpoints(bar8_data0a$Breakpoints))), decreasing=T))
bkpts_bar8_data0b = as.data.frame(sort(table(na.omit(all_breakpoints(bar8_data0b$Breakpoints))), decreasing=T))
bkpts_bar8_data1 = as.data.frame(sort(table(na.omit(all_breakpoints(bar8_data1$Breakpoints))), decreasing=T))
bkpts_bar8_data2 = as.data.frame(sort(table(na.omit(all_breakpoints(bar8_data2$Breakpoints))), decreasing=T))
bkpts_bar8_data3 = as.data.frame(sort(table(na.omit(all_breakpoints(bar8_data3$Breakpoints))), decreasing=T))
bkpts_bar8_data4 = as.data.frame(sort(table(na.omit(all_breakpoints(bar8_data4$Breakpoints))), decreasing=T))
bkpts_bar8_data5 = as.data.frame(sort(table(na.omit(all_breakpoints(bar8_data5$Breakpoints))), decreasing=T))
bkpts_bar8_data6 = as.data.frame(sort(table(na.omit(all_breakpoints(bar8_data6$Breakpoints))), decreasing=T))
bkpts_bar8_data7 = as.data.frame(sort(table(na.omit(all_breakpoints(bar8_data7$Breakpoints))), decreasing=T))
bkpts_bar8_data8 = as.data.frame(sort(table(na.omit(all_breakpoints(bar8_data8$Breakpoints))), decreasing=T))
bkpts_bar8_data9 = as.data.frame(sort(table(na.omit(all_breakpoints(bar8_data9$Breakpoints))), decreasing=T))
bkpts_bar8_data10 = as.data.frame(sort(table(na.omit(all_breakpoints(bar8_data10$Breakpoints))), decreasing=T))

###function to check if no breakpoints were ever found
breakpoint_check = function(breakpoints){

	threshold <<- 0.15 * 3000 * 9

	if(dim(breakpoints)[[2]] > 1){
		final_breakpoints = paste(breakpoints[breakpoints[,2] >= threshold, 1], sep="", collapse=", ")
		return(final_breakpoints)
	}else if(breakpoints[,1][[1]] == 27000){
		final_breakpoints = paste(rownames(breakpoints)[which(breakpoints == 27000)], sep="", collapse=", ")
		return(final_breakpoints)
	}else{
		return("")
	}

}

###putting breakpoints into rows based on data
bkpts_data0a = cbind(breakpoint_check(bkpts_bar0_data0a), breakpoint_check(bkpts_bar1_data0a),
breakpoint_check(bkpts_bar2_data0a), breakpoint_check(bkpts_bar3_data0a),
breakpoint_check(bkpts_bar4_data0a), breakpoint_check(bkpts_bar5_data0a),
breakpoint_check(bkpts_bar6_data0a), breakpoint_check(bkpts_bar7_data0a),
breakpoint_check(bkpts_bar8_data0a))
bkpts_data0b = cbind(breakpoint_check(bkpts_bar0_data0b), breakpoint_check(bkpts_bar1_data0b),
breakpoint_check(bkpts_bar2_data0b), breakpoint_check(bkpts_bar3_data0b),
breakpoint_check(bkpts_bar4_data0b), breakpoint_check(bkpts_bar5_data0b),
breakpoint_check(bkpts_bar6_data0b), breakpoint_check(bkpts_bar7_data0b),
breakpoint_check(bkpts_bar8_data0b))
bkpts_data1 = cbind(breakpoint_check(bkpts_bar0_data1), breakpoint_check(bkpts_bar1_data1),
breakpoint_check(bkpts_bar2_data1), breakpoint_check(bkpts_bar3_data1),
breakpoint_check(bkpts_bar4_data1), breakpoint_check(bkpts_bar5_data1),
breakpoint_check(bkpts_bar6_data1), breakpoint_check(bkpts_bar7_data1),
breakpoint_check(bkpts_bar8_data1))
bkpts_data2 = cbind(breakpoint_check(bkpts_bar0_data2), breakpoint_check(bkpts_bar1_data2),
breakpoint_check(bkpts_bar2_data2), breakpoint_check(bkpts_bar3_data2),
breakpoint_check(bkpts_bar4_data2), breakpoint_check(bkpts_bar5_data2),
breakpoint_check(bkpts_bar6_data2), breakpoint_check(bkpts_bar7_data2),
breakpoint_check(bkpts_bar8_data2))
bkpts_data3 = cbind(breakpoint_check(bkpts_bar0_data3), breakpoint_check(bkpts_bar1_data3),
breakpoint_check(bkpts_bar2_data3), breakpoint_check(bkpts_bar3_data3),
breakpoint_check(bkpts_bar4_data3), breakpoint_check(bkpts_bar5_data3),
breakpoint_check(bkpts_bar6_data3), breakpoint_check(bkpts_bar7_data3),
breakpoint_check(bkpts_bar8_data3))
bkpts_data4 = cbind(breakpoint_check(bkpts_bar0_data4), breakpoint_check(bkpts_bar1_data4),
breakpoint_check(bkpts_bar2_data4), breakpoint_check(bkpts_bar3_data4),
breakpoint_check(bkpts_bar4_data4), breakpoint_check(bkpts_bar5_data4),
breakpoint_check(bkpts_bar6_data4), breakpoint_check(bkpts_bar7_data4),
breakpoint_check(bkpts_bar8_data4))
bkpts_data5 = cbind(breakpoint_check(bkpts_bar0_data5), breakpoint_check(bkpts_bar1_data5),
breakpoint_check(bkpts_bar2_data5), breakpoint_check(bkpts_bar3_data5),
breakpoint_check(bkpts_bar4_data5), breakpoint_check(bkpts_bar5_data5),
breakpoint_check(bkpts_bar6_data5), breakpoint_check(bkpts_bar7_data5),
breakpoint_check(bkpts_bar8_data5))
bkpts_data6 = cbind(breakpoint_check(bkpts_bar0_data6), breakpoint_check(bkpts_bar1_data6),
breakpoint_check(bkpts_bar2_data6), breakpoint_check(bkpts_bar3_data6),
breakpoint_check(bkpts_bar4_data6), breakpoint_check(bkpts_bar5_data6),
breakpoint_check(bkpts_bar6_data6), breakpoint_check(bkpts_bar7_data6),
breakpoint_check(bkpts_bar8_data6))
bkpts_data7 = cbind(breakpoint_check(bkpts_bar0_data7), breakpoint_check(bkpts_bar1_data7),
breakpoint_check(bkpts_bar2_data7), breakpoint_check(bkpts_bar3_data7),
breakpoint_check(bkpts_bar4_data7), breakpoint_check(bkpts_bar5_data7),
breakpoint_check(bkpts_bar6_data7), breakpoint_check(bkpts_bar7_data7),
breakpoint_check(bkpts_bar8_data7))
bkpts_data8 = cbind(breakpoint_check(bkpts_bar0_data8), breakpoint_check(bkpts_bar1_data8),
breakpoint_check(bkpts_bar2_data8), breakpoint_check(bkpts_bar3_data8),
breakpoint_check(bkpts_bar4_data8), breakpoint_check(bkpts_bar5_data8),
breakpoint_check(bkpts_bar6_data8), breakpoint_check(bkpts_bar7_data8),
breakpoint_check(bkpts_bar8_data8))
bkpts_data9 = cbind(breakpoint_check(bkpts_bar0_data9), breakpoint_check(bkpts_bar1_data9),
breakpoint_check(bkpts_bar2_data9), breakpoint_check(bkpts_bar3_data9),
breakpoint_check(bkpts_bar4_data9), breakpoint_check(bkpts_bar5_data9),
breakpoint_check(bkpts_bar6_data9), breakpoint_check(bkpts_bar7_data9),
breakpoint_check(bkpts_bar8_data9))
bkpts_data10 = cbind(breakpoint_check(bkpts_bar0_data10), breakpoint_check(bkpts_bar1_data10),
breakpoint_check(bkpts_bar2_data10), breakpoint_check(bkpts_bar3_data10),
breakpoint_check(bkpts_bar4_data10), breakpoint_check(bkpts_bar5_data10),
breakpoint_check(bkpts_bar6_data10), breakpoint_check(bkpts_bar7_data10),
breakpoint_check(bkpts_bar8_data10))

##creating a single data frame with breakpoints above threshold
bkpts = rbind(bkpts_data0a, bkpts_data0b, bkpts_data1, bkpts_data2,
bkpts_data3, bkpts_data4, bkpts_data5, bkpts_data6, bkpts_data7,
bkpts_data8, bkpts_data9, bkpts_data10)
rownames(bkpts) = c(datanames, recursive=T)
colnames(bkpts) = c("bar0", "bar1", "bar2", "bar3", "bar4", "bar5", "bar6", "bar7", "bar8")
bkpts

##graphically

###function to get single list of all breakpoint locations
all_breakpoints_graph <- function(breakpoints){

	full_breakpoints = NULL

	for(m in 1:length(breakpoints)){ 
		if(is.atomic(breakpoints[[m]]) == TRUE) {
			full_breakpoints = c(full_breakpoints, breakpoints[[m]], recursive=T)
		}else if(dim(breakpoints[[m]])[2] >= 2) {
			column_list = NULL
			for(i in 1:dim(breakpoints[[m]])[2]){
				column_list = c(column_list, breakpoints[[m]][,i], recursive=TRUE)
			}
		full_breakpoints = c(full_breakpoints, column_list, recursive=T)
		}
	}

	return(full_breakpoints)

}

par(mfrow=c(1,2))
hist(all_breakpoints_graph(bar0_data4$Breakpoints), col="red",
ylim=c(0,20000), right=F, breaks=c(seq(1,90,4)), xlim=c(4,96),
main="BAR 0", ylab="Number of Iterations Out of 27,000",
xlab="Locations of Breakpoints (in Observations)")
hist(all_breakpoints_graph(bar5_data4$Breakpoints), col="lightblue",
ylim=c(0,20000), right=F, breaks=c(seq(1,90,4)), xlim=c(4,96),
main="BAR 5", ylab="Number of Iterations Out of 27,000",
xlab="Locations of Breakpoints (in Observations)")

###function to plot frequency of breakpoints
plot_tau_hist <- function(breakpoints, title, x_axis_lab, y_axis_lab, color, num_breaks, x_axis_limits, y_axis_limits){
 
	if(is.atomic(breakpoints) == TRUE) {
		hist(breakpoints, main=title, xlab=x_axis_lab, ylab=y_axis_lab, col=color, breaks=num_breaks, xlim=x_axis_limits, ylim=y_axis_limits) 
	}else if(dim(breakpoints)[2] >= 2) {
		column_list = NULL
		for(i in 1:dim(breakpoints)[2]){
			column_list = c(column_list, breakpoints[,i], recursive=TRUE)
		}
		hist(column_list, main=title, xlab=x_axis_lab, ylab=y_axis_lab, col=color, breaks=num_breaks, xlim=x_axis_limits, ylim=y_axis_limits) 
	}

}

###specify which simulation you want to look at right now
current_sim = bar0_data2$Breakpoints
current_title = "bar0 - Data 2"
###specify correct locations of breakpoints for this training set
current_true = c(30,60)

###set graphical parameters
x_label = "Location of Breakpoints"
y_label = "Number of Iterations"
n_breaks = c(1:90)
x_limits = c(1,90)
y_lower = 0
y_upper = 2500
bar_color = "yellow2"
line_color = "red1"
line_type = 2
line_width = 1

###plot distributions of breakpoint locations
par(mfrow=c(3,3))
plot_tau_hist(current_sim[[1]], current_title, x_label, y_label, bar_color, n_breaks, x_limits, c(y_lower, y_upper))
if(length(current_true)>=1){lines(c(current_true[[1]],current_true[[1]]),c(y_lower,y_upper),col=line_color, lty=line_type, lwd=line_width)}
if(length(current_true)>=2){lines(c(current_true[[2]],current_true[[2]]),c(y_lower,y_upper),col=line_color, lty=line_type, lwd=line_width)}
plot_tau_hist(current_sim[[2]], current_title, x_label, y_label, bar_color, n_breaks, x_limits, c(y_lower, y_upper))
if(length(current_true)>=1){lines(c(current_true[[1]],current_true[[1]]),c(y_lower,y_upper),col=line_color, lty=line_type, lwd=line_width)}
if(length(current_true)>=2){lines(c(current_true[[2]],current_true[[2]]),c(y_lower,y_upper),col=line_color, lty=line_type, lwd=line_width)}
plot_tau_hist(current_sim[[3]], current_title, x_label, y_label, bar_color, n_breaks, x_limits, c(y_lower, y_upper))
if(length(current_true)>=1){lines(c(current_true[[1]],current_true[[1]]),c(y_lower,y_upper),col=line_color, lty=line_type, lwd=line_width)}
if(length(current_true)>=2){lines(c(current_true[[2]],current_true[[2]]),c(y_lower,y_upper),col=line_color, lty=line_type, lwd=line_width)}
plot_tau_hist(current_sim[[4]], current_title, x_label, y_label, bar_color, n_breaks, x_limits, c(y_lower, y_upper))
if(length(current_true)>=1){lines(c(current_true[[1]],current_true[[1]]),c(y_lower,y_upper),col=line_color, lty=line_type, lwd=line_width)}
if(length(current_true)>=2){lines(c(current_true[[2]],current_true[[2]]),c(y_lower,y_upper),col=line_color, lty=line_type, lwd=line_width)}
plot_tau_hist(current_sim[[5]], current_title, x_label, y_label, bar_color, n_breaks, x_limits, c(y_lower, y_upper))
if(length(current_true)>=1){lines(c(current_true[[1]],current_true[[1]]),c(y_lower,y_upper),col=line_color, lty=line_type, lwd=line_width)}
if(length(current_true)>=2){lines(c(current_true[[2]],current_true[[2]]),c(y_lower,y_upper),col=line_color, lty=line_type, lwd=line_width)}
plot_tau_hist(current_sim[[6]], current_title, x_label, y_label, bar_color, n_breaks, x_limits, c(y_lower, y_upper))
if(length(current_true)>=1){lines(c(current_true[[1]],current_true[[1]]),c(y_lower,y_upper),col=line_color, lty=line_type, lwd=line_width)}
if(length(current_true)>=2){lines(c(current_true[[2]],current_true[[2]]),c(y_lower,y_upper),col=line_color, lty=line_type, lwd=line_width)}
plot_tau_hist(current_sim[[7]], current_title, x_label, y_label, bar_color, n_breaks, x_limits, c(y_lower, y_upper))
if(length(current_true)>=1){lines(c(current_true[[1]],current_true[[1]]),c(y_lower,y_upper),col=line_color, lty=line_type, lwd=line_width)}
if(length(current_true)>=2){lines(c(current_true[[2]],current_true[[2]]),c(y_lower,y_upper),col=line_color, lty=line_type, lwd=line_width)}
plot_tau_hist(current_sim[[8]], current_title, x_label, y_label, bar_color, n_breaks, x_limits, c(y_lower, y_upper))
if(length(current_true)>=1){lines(c(current_true[[1]],current_true[[1]]),c(y_lower,y_upper),col=line_color, lty=line_type, lwd=line_width)}
if(length(current_true)>=2){lines(c(current_true[[2]],current_true[[2]]),c(y_lower,y_upper),col=line_color, lty=line_type, lwd=line_width)}
plot_tau_hist(current_sim[[9]], current_title, x_label, y_label, bar_color, n_breaks, x_limits, c(y_lower, y_upper))
if(length(current_true)>=1){lines(c(current_true[[1]],current_true[[1]]),c(y_lower,y_upper),col=line_color, lty=line_type, lwd=line_width)}
if(length(current_true)>=2){lines(c(current_true[[2]],current_true[[2]]),c(y_lower,y_upper),col=line_color, lty=line_type, lwd=line_width)}